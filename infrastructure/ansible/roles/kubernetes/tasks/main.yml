# ============================================
# Kubernetes Role - Main Tasks
# ============================================
---
- name: Include common tasks
  include_tasks: common.yml

- name: Install AWS CLI on master
  include_tasks: awscli.yml
  when: "'k8s_master' in group_names"

- name: Install and configure Git on master
  include_tasks: git.yml
  when: "'k8s_master' in group_names"

- name: Configure master node
  include_tasks: master.yml
  when: "'k8s_master' in group_names"

- name: Configure worker nodes
  include_tasks: worker.yml
  when: "'k8s_workers' in group_names"

- name: Deploy SonarQube to cluster
  include_tasks: sonarqube.yml
  when: "'k8s_master' in group_names"

- name: Deploy Monitoring Stack (Prometheus + Grafana)
  include_tasks: monitoring.yml
  when: "'k8s_master' in group_names"
